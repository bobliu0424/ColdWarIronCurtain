MOR_percentage_update_calc = {
    MOR = {
        add_to_variable = { refresh_MOR = 1 }
    }
    FRA = {
        add_to_variable = { refresh_MOR = 1 }
    }
    RIF = {
        add_to_variable = { refresh_MOR = 1 }
    }
    SPR = {
        add_to_variable = { refresh_MOR = 1 }
    }
    1468 = {
        set_variable = { morrocco_faction_total = 0 }
        set_variable = { french_influence_percentage = french_influence }
        set_variable = { spanish_influence_percentage = spanish_influence }
        set_variable = { istqal_influence_percentage = istqal_influence }
        set_variable = { nobility_influence_percentage = nobility_influence }
        set_variable = { republican_influence_percentage = republican_influence }
            
        add_to_variable = { morrocco_faction_total = french_influence }
        add_to_variable = { morrocco_faction_total = spanish_influence }
        add_to_variable = { morrocco_faction_total = istqal_influence }
        add_to_variable = { morrocco_faction_total = nobility_influence }
        add_to_variable = { morrocco_faction_total = republican_influence }	


        divide_variable = { french_influence_percentage = morrocco_faction_total }	
        divide_variable = { spanish_influence_percentage = morrocco_faction_total }	
        divide_variable = { istqal_influence_percentage = morrocco_faction_total }	
        divide_variable = { nobility_influence_percentage = morrocco_faction_total }	
        divide_variable = { republican_influence_percentage = morrocco_faction_total }			
    }
    1056 = {
        set_variable = { morrocco_faction_total = 0 }
        set_variable = { french_influence_percentage = french_influence }
        set_variable = { spanish_influence_percentage = spanish_influence }
        set_variable = { istqal_influence_percentage = istqal_influence }
        set_variable = { nobility_influence_percentage = nobility_influence }
        set_variable = { republican_influence_percentage = republican_influence }
            
        add_to_variable = { morrocco_faction_total = french_influence }
        add_to_variable = { morrocco_faction_total = spanish_influence }
        add_to_variable = { morrocco_faction_total = istqal_influence }
        add_to_variable = { morrocco_faction_total = nobility_influence }
        add_to_variable = { morrocco_faction_total = republican_influence }	


        divide_variable = { french_influence_percentage = morrocco_faction_total }	
        divide_variable = { spanish_influence_percentage = morrocco_faction_total }	
        divide_variable = { istqal_influence_percentage = morrocco_faction_total }	
        divide_variable = { nobility_influence_percentage = morrocco_faction_total }	
        divide_variable = { republican_influence_percentage = morrocco_faction_total }			
    }
    930 = {
        set_variable = { morrocco_faction_total = 0 }
        set_variable = { french_influence_percentage = french_influence }
        set_variable = { spanish_influence_percentage = spanish_influence }
        set_variable = { istqal_influence_percentage = istqal_influence }
        set_variable = { nobility_influence_percentage = nobility_influence }
        set_variable = { republican_influence_percentage = republican_influence }
            
        add_to_variable = { morrocco_faction_total = french_influence }
        add_to_variable = { morrocco_faction_total = spanish_influence }
        add_to_variable = { morrocco_faction_total = istqal_influence }
        add_to_variable = { morrocco_faction_total = nobility_influence }
        add_to_variable = { morrocco_faction_total = republican_influence }	


        divide_variable = { french_influence_percentage = morrocco_faction_total }	
        divide_variable = { spanish_influence_percentage = morrocco_faction_total }	
        divide_variable = { istqal_influence_percentage = morrocco_faction_total }	
        divide_variable = { nobility_influence_percentage = morrocco_faction_total }	
        divide_variable = { republican_influence_percentage = morrocco_faction_total }			
    }
    929 = {
        set_variable = { morrocco_faction_total = 0 }
        set_variable = { french_influence_percentage = french_influence }
        set_variable = { spanish_influence_percentage = spanish_influence }
        set_variable = { istqal_influence_percentage = istqal_influence }
        set_variable = { nobility_influence_percentage = nobility_influence }
        set_variable = { republican_influence_percentage = republican_influence }
            
        add_to_variable = { morrocco_faction_total = french_influence }
        add_to_variable = { morrocco_faction_total = spanish_influence }
        add_to_variable = { morrocco_faction_total = istqal_influence }
        add_to_variable = { morrocco_faction_total = nobility_influence }
        add_to_variable = { morrocco_faction_total = republican_influence }	


        divide_variable = { french_influence_percentage = morrocco_faction_total }	
        divide_variable = { spanish_influence_percentage = morrocco_faction_total }	
        divide_variable = { istqal_influence_percentage = morrocco_faction_total }	
        divide_variable = { nobility_influence_percentage = morrocco_faction_total }	
        divide_variable = { republican_influence_percentage = morrocco_faction_total }			
    }
    461 = {
        set_variable = { morrocco_faction_total = 0 }
        set_variable = { french_influence_percentage = french_influence }
        set_variable = { spanish_influence_percentage = spanish_influence }
        set_variable = { istqal_influence_percentage = istqal_influence }
        set_variable = { nobility_influence_percentage = nobility_influence }
        set_variable = { republican_influence_percentage = republican_influence }
            
        add_to_variable = { morrocco_faction_total = french_influence }
        add_to_variable = { morrocco_faction_total = spanish_influence }
        add_to_variable = { morrocco_faction_total = istqal_influence }
        add_to_variable = { morrocco_faction_total = nobility_influence }
        add_to_variable = { morrocco_faction_total = republican_influence }	


        divide_variable = { french_influence_percentage = morrocco_faction_total }	
        divide_variable = { spanish_influence_percentage = morrocco_faction_total }	
        divide_variable = { istqal_influence_percentage = morrocco_faction_total }	
        divide_variable = { nobility_influence_percentage = morrocco_faction_total }	
        divide_variable = { republican_influence_percentage = morrocco_faction_total }			
    }
    462 = {
        set_variable = { morrocco_faction_total = 0 }
        set_variable = { french_influence_percentage = french_influence }
        set_variable = { spanish_influence_percentage = spanish_influence }
        set_variable = { istqal_influence_percentage = istqal_influence }
        set_variable = { nobility_influence_percentage = nobility_influence }
        set_variable = { republican_influence_percentage = republican_influence }
            
        add_to_variable = { morrocco_faction_total = french_influence }
        add_to_variable = { morrocco_faction_total = spanish_influence }
        add_to_variable = { morrocco_faction_total = istqal_influence }
        add_to_variable = { morrocco_faction_total = nobility_influence }
        add_to_variable = { morrocco_faction_total = republican_influence }	


        divide_variable = { french_influence_percentage = morrocco_faction_total }	
        divide_variable = { spanish_influence_percentage = morrocco_faction_total }	
        divide_variable = { istqal_influence_percentage = morrocco_faction_total }	
        divide_variable = { nobility_influence_percentage = morrocco_faction_total }	
        divide_variable = { republican_influence_percentage = morrocco_faction_total }			
    }
    1469 = {
        set_variable = { morrocco_faction_total = 0 }
        set_variable = { french_influence_percentage = french_influence }
        set_variable = { spanish_influence_percentage = spanish_influence }
        set_variable = { istqal_influence_percentage = istqal_influence }
        set_variable = { nobility_influence_percentage = nobility_influence }
        set_variable = { republican_influence_percentage = republican_influence }
            
        add_to_variable = { morrocco_faction_total = french_influence }
        add_to_variable = { morrocco_faction_total = spanish_influence }
        add_to_variable = { morrocco_faction_total = istqal_influence }
        add_to_variable = { morrocco_faction_total = nobility_influence }
        add_to_variable = { morrocco_faction_total = republican_influence }	


        divide_variable = { french_influence_percentage = morrocco_faction_total }	
        divide_variable = { spanish_influence_percentage = morrocco_faction_total }	
        divide_variable = { istqal_influence_percentage = morrocco_faction_total }	
        divide_variable = { nobility_influence_percentage = morrocco_faction_total }	
        divide_variable = { republican_influence_percentage = morrocco_faction_total }			
    }
    1471 = {
        set_variable = { morrocco_faction_total = 0 }
        set_variable = { french_influence_percentage = french_influence }
        set_variable = { spanish_influence_percentage = spanish_influence }
        set_variable = { istqal_influence_percentage = istqal_influence }
        set_variable = { nobility_influence_percentage = nobility_influence }
        set_variable = { republican_influence_percentage = republican_influence }
            
        add_to_variable = { morrocco_faction_total = french_influence }
        add_to_variable = { morrocco_faction_total = spanish_influence }
        add_to_variable = { morrocco_faction_total = istqal_influence }
        add_to_variable = { morrocco_faction_total = nobility_influence }
        add_to_variable = { morrocco_faction_total = republican_influence }	


        divide_variable = { french_influence_percentage = morrocco_faction_total }	
        divide_variable = { spanish_influence_percentage = morrocco_faction_total }	
        divide_variable = { istqal_influence_percentage = morrocco_faction_total }	
        divide_variable = { nobility_influence_percentage = morrocco_faction_total }	
        divide_variable = { republican_influence_percentage = morrocco_faction_total }			
    }
    1003 = {
        set_variable = { morrocco_faction_total = 0 }
        set_variable = { french_influence_percentage = french_influence }
        set_variable = { spanish_influence_percentage = spanish_influence }
        set_variable = { istqal_influence_percentage = istqal_influence }
        set_variable = { nobility_influence_percentage = nobility_influence }
        set_variable = { republican_influence_percentage = republican_influence }
            
        add_to_variable = { morrocco_faction_total = french_influence }
        add_to_variable = { morrocco_faction_total = spanish_influence }
        add_to_variable = { morrocco_faction_total = istqal_influence }
        add_to_variable = { morrocco_faction_total = nobility_influence }
        add_to_variable = { morrocco_faction_total = republican_influence }	


        divide_variable = { french_influence_percentage = morrocco_faction_total }	
        divide_variable = { spanish_influence_percentage = morrocco_faction_total }	
        divide_variable = { istqal_influence_percentage = morrocco_faction_total }	
        divide_variable = { nobility_influence_percentage = morrocco_faction_total }	
        divide_variable = { republican_influence_percentage = morrocco_faction_total }			
    }
    1002 = {
        set_variable = { morrocco_faction_total = 0 }
        set_variable = { french_influence_percentage = french_influence }
        set_variable = { spanish_influence_percentage = spanish_influence }
        set_variable = { istqal_influence_percentage = istqal_influence }
        set_variable = { nobility_influence_percentage = nobility_influence }
        set_variable = { republican_influence_percentage = republican_influence }
            
        add_to_variable = { morrocco_faction_total = french_influence }
        add_to_variable = { morrocco_faction_total = spanish_influence }
        add_to_variable = { morrocco_faction_total = istqal_influence }
        add_to_variable = { morrocco_faction_total = nobility_influence }
        add_to_variable = { morrocco_faction_total = republican_influence }	


        divide_variable = { french_influence_percentage = morrocco_faction_total }	
        divide_variable = { spanish_influence_percentage = morrocco_faction_total }	
        divide_variable = { istqal_influence_percentage = morrocco_faction_total }	
        divide_variable = { nobility_influence_percentage = morrocco_faction_total }	
        divide_variable = { republican_influence_percentage = morrocco_faction_total }			
    }
    1470 = {
        set_variable = { morrocco_faction_total = 0 }
        set_variable = { french_influence_percentage = french_influence }
        set_variable = { spanish_influence_percentage = spanish_influence }
        set_variable = { istqal_influence_percentage = istqal_influence }
        set_variable = { nobility_influence_percentage = nobility_influence }
        set_variable = { republican_influence_percentage = republican_influence }
            
        add_to_variable = { morrocco_faction_total = french_influence }
        add_to_variable = { morrocco_faction_total = spanish_influence }
        add_to_variable = { morrocco_faction_total = istqal_influence }
        add_to_variable = { morrocco_faction_total = nobility_influence }
        add_to_variable = { morrocco_faction_total = republican_influence }	


        divide_variable = { french_influence_percentage = morrocco_faction_total }	
        divide_variable = { spanish_influence_percentage = morrocco_faction_total }	
        divide_variable = { istqal_influence_percentage = morrocco_faction_total }	
        divide_variable = { nobility_influence_percentage = morrocco_faction_total }	
        divide_variable = { republican_influence_percentage = morrocco_faction_total }			
    }
    290 = {
        set_variable = { morrocco_faction_total = 0 }
        set_variable = { french_influence_percentage = french_influence }
        set_variable = { spanish_influence_percentage = spanish_influence }
        set_variable = { istqal_influence_percentage = istqal_influence }
        set_variable = { nobility_influence_percentage = nobility_influence }
        set_variable = { republican_influence_percentage = republican_influence }
            
        add_to_variable = { morrocco_faction_total = french_influence }
        add_to_variable = { morrocco_faction_total = spanish_influence }
        add_to_variable = { morrocco_faction_total = istqal_influence }
        add_to_variable = { morrocco_faction_total = nobility_influence }
        add_to_variable = { morrocco_faction_total = republican_influence }	


        divide_variable = { french_influence_percentage = morrocco_faction_total }	
        divide_variable = { spanish_influence_percentage = morrocco_faction_total }	
        divide_variable = { istqal_influence_percentage = morrocco_faction_total }	
        divide_variable = { nobility_influence_percentage = morrocco_faction_total }	
        divide_variable = { republican_influence_percentage = morrocco_faction_total }			
    }
}

chinese_warlord_era_electric_boogalo = {
    set_global_flag = WARLORD_ERA_2
    news_event = ROC_CLIQUE.15
    597 = { set_state_flag = Red_Spear_Base }
    607 = { set_state_flag = Red_Spear_Base }

    activate_mission = Red_Spear_Uprising
    if = {
        limit = {
			NOT = {
				has_country_flag = YUN_INTEGRATED
				has_country_flag = YUN_REBELLION
			}            
        }
        start_civil_war = {
            ruling_party = conservative
            ideology = neutrality
            size = 0.1
            states = all
            states_filter = {
                has_state_flag = YUN_PRESENT
            }
            create_country_leader = {
                name = "Li Mi"
                picture = "Li_Mi.dds"
                ideology = military_junta
            }
            set_cosmetic_tag = YUNNAN
        }
    }
    if = {
        limit = {
			NOT = {
				has_country_flag = SHX_INTEGRATED
				has_country_flag = SHX_REBELLION
			}            
        }
        start_civil_war = {
            ruling_party = conservative
            ideology = neutrality
            size = 0.1
            states = all
            states_filter = {
                has_state_flag = SHX_PRESENT
            }
            create_country_leader = {
                name = "Yan Xishan"
                picture = "Yan_Xishan.dds"
                ideology = military_junta
            }
            set_cosmetic_tag = SHANXI
        }
    }
    if = {
        limit = {
			NOT = {
				has_country_flag = QMC_INTEGRATED
				has_country_flag = QMC_REBELLION
			}            
        }
        start_civil_war = {
            ruling_party = conservative
            ideology = neutrality
            size = 0.1
            states = all
            states_filter = {
                has_state_flag = QMC_PRESENT
            }
            create_country_leader = {
                name = "Ma Bufang"
                picture = "Ma_Bufang.dds"
                ideology = military_junta
            }
            set_cosmetic_tag = QINGHAI_MA
        }
    }
    if = {
        limit = {
			NOT = {
				has_country_flag = HUN_INTEGRATED
				has_country_flag = HUN_REBELLION
			}            
        }
        start_civil_war = {
            ruling_party = conservative
            ideology = neutrality
            size = 0.1
            states = all
            states_filter = {
                has_state_flag = HUN_PRESENT
            }
            create_country_leader = {
                name = "Cheng Qian"
                picture = "Cheng_Qian.dds"
                ideology = military_junta
            }
            set_cosmetic_tag = HUNAN
        }
    }
    if = {
        limit = {
			NOT = {
				has_country_flag = NMC_INTEGRATED
				has_country_flag = NMC_REBELLION
			}            
        }
        start_civil_war = {
            ruling_party = conservative
            ideology = neutrality
            size = 0.1
            states = all
            states_filter = {
                has_state_flag = NMC_PRESENT
            }
            create_country_leader = {
                name = "Ma Hongbin"
                picture = "Ma_Hongbin.dds"
                ideology = military_junta
            }
            set_cosmetic_tag = NINGXIA_MA
        }
    }
    if = {
        limit = {
			NOT = {
				has_country_flag = GUX_INTEGRATED
				has_country_flag = GUX_REBELLION
			}            
        }
        start_civil_war = {
            ruling_party = conservative
            ideology = neutrality
            size = 0.1
            states = all
            states_filter = {
                has_state_flag = GUX_PRESENT
            }
            create_country_leader = {
                name = "Li Zongren"
                picture = "Li_Zongren.dds"
                ideology = military_junta
            }
            set_cosmetic_tag = NGUX
        }
    }
    if = {
        limit = {
			NOT = {
				has_country_flag = XIK_INTEGRATED
				has_country_flag = XIK_REBELLION
			}            
        }
        start_civil_war = {
            ruling_party = conservative
            ideology = neutrality
            size = 0.1
            states = all
            states_filter = {
                has_state_flag = XIK_PRESENT
            }
            create_country_leader = {
                name = "Liu Wenhui"
                picture = "Liu_Wenhui.dds"
                ideology = military_junta
            }
            set_cosmetic_tag = XIKANG
        }
    }
}

rif_revert_morocco = {
	every_state = {
		remove_core_of = RIF
	}
	290 = { add_core_of = RIF }
	929 = { add_core_of = RIF }
	930 = { add_core_of = RIF }
	1056 = { add_core_of = RIF }
	RIF = {
		if = {
			limit = { has_government = monarchism }
			retire_ideology_leader = monarchism
		}
		drop_cosmetic_tag = yes
		set_politics = {
			ruling_party = nationalist
		}
		set_popularities = { nationalist = 100 }
		set_capital = { state = 290 }
		set_party_name = { 
			ideology = monarchism 
			long_name = "Monarchist"
			name = "Monarchist" 
		}
	}
	FRA = { remove_ideas = saf_dont_call_ally }
	clr_global_flag = morocco_civil_war
}